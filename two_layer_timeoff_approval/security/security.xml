<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- GROUPS / ROLES -->

        <!-- 1. Time Off Administrator (Full Access) -->
        <record id="group_timeoff_administrator" model="res.groups">
            <field name="name">Time Off Administrator</field>
            <field name="implied_ids" eval="[(4, ref('hr_holidays.group_hr_holidays_user'))]"/>
            <field name="comment">Full access to time off management. Can approve at any level.</field>
        </record>

        <!-- 2. HR Manager (Second-level approval) -->
        <record id="group_hr_manager" model="res.groups">
            <field name="name">HR Manager (Time Off)</field>
            <field name="implied_ids" eval="[(4, ref('hr_holidays.group_hr_holidays_user'))]"/>
            <field name="comment">Can perform second-level (final) approval of time off requests.</field>
        </record>

        <!-- 3. Team Leader (First-level approval) -->
        <record id="group_team_leader" model="res.groups">
            <field name="name">Team Leader (Time Off)</field>
            <field name="implied_ids" eval="[(4, ref('hr_holidays.group_hr_holidays_user'))]"/>
            <field name="comment">Can perform first-level approval for their team members only.</field>
        </record>

        <!-- RECORD RULES -->

        <!-- Administrator: See all time off requests -->
        <record id="hr_leave_rule_administrator" model="ir.rule">
            <field name="name">Time Off: Administrator - All Access</field>
            <field name="model_id" ref="hr_holidays.model_hr_leave"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_timeoff_administrator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- HR Manager: See all time off requests -->
        <record id="hr_leave_rule_hr_manager" model="ir.rule">
            <field name="name">Time Off: HR Manager - All Requests</field>
            <field name="model_id" ref="hr_holidays.model_hr_leave"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_hr_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Team Leader: See only their team members' requests -->
        <record id="hr_leave_rule_team_leader" model="ir.rule">
            <field name="name">Time Off: Team Leader - Team Members Only</field>
            <field name="model_id" ref="hr_holidays.model_hr_leave"/>
            <field name="domain_force">[
                '|',
                ('employee_id.parent_id.user_id', '=', user.id),
                ('employee_id.user_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('group_team_leader'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

    </data>
</odoo>